<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anuncios ‚Äî CBTis 179</title>

<style>
    body {
        font-family: 'Poppins', sans-serif;
        margin: 0;
        background: #f5f5f5;
    }

    header {
        background: #3E4A61;
        color: white;
        padding: 1rem;
        text-align: center;
        font-size: 1.3rem;
        font-weight: bold;
        letter-spacing: 0.5px;
    }

    .container {
        max-width: 1100px;
        margin: auto;
        padding: 1rem;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.2rem;
    }

    .card {
        background: white;
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transition: transform 0.15s ease;
        position: relative;
    }
    .card:hover { transform: translateY(-3px); }

    .azul { background: #A7C7E7; }
    .lila { background: #D9C4F1; }
    .menta { background: #B8E0D2; }
    .amarillo { background: #FFF4B2; }
    .durazno { background: #FFE1B2; }

    .content { padding: 1rem; }
    .title { font-size: 1.1rem; font-weight: 700; margin-bottom: 0.4rem; color: #333; }
    .desc { font-size: 0.9rem; color: #444; margin-bottom: 0.5rem; }
    .date { font-size: 0.8rem; font-weight: bold; color: #333; }

    .collage {
        display: grid;
        gap: 4px;
        padding: 4px;
    }
    .collage img {
        width: 100%;
        height: 140px;
        object-fit: cover;
        border-radius: 10px;
    }

    .collage.two {
        grid-template-columns: repeat(2, 1fr);
    }

    .collage.three {
        grid-template-columns: repeat(3, 1fr);
    }

    .carousel-container {
        position: relative;
        overflow: hidden;
    }

    .carousel-track {
        display: flex;
        transition: transform 0.3s ease-in-out;
    }

    .carousel-track img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        flex-shrink: 0;
    }

    .like-container {
        position: absolute;
        top: 12px;
        right: 12px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 4px;
        background: rgba(255,255,255,0.85);
        padding: 4px 10px;
        border-radius: 20px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    .heart {
        font-size: 1.3rem;
        color: #3E4A61;
        transition: 0.2s ease;
    }

    .liked {
        color: #2E8BC0;
        transform: scale(1.2);
    }

</style>
</head>

<body>

<header>üì¢ Actividades y Anuncios ‚Äî CBTis 179</header>

<div id="gallery" class="container"></div>

<script>

// ‚úî ESTA ES LA √öNICA L√çNEA CORRECTA
const API_URL = "https://script.google.com/macros/s/AKfycby70esfLiU5oJmTsXXgF8JcPWTJ75weN2nZD-V3hj2c0mwTkVjaeBMH6QWXQn99yjeaag/exec";

const colores = {
    "Academicos": "azul",
    "Eventos": "lila",
    "Servicios": "menta",
    "Convocatorias": "amarillo",
    "Informativos": "durazno"
};

function toggleLike(id) {
    let likes = JSON.parse(localStorage.getItem("likes_gallery")) || {};
    likes[id] = !likes[id];
    localStorage.setItem("likes_gallery", JSON.stringify(likes));
    loadGallery();
}

function loadGallery() {
    fetch(API_URL)
        .then(res => res.json())
        .then(data => {
            const gallery = document.getElementById("gallery");
            gallery.innerHTML = "";

            const likes = JSON.parse(localStorage.getItem("likes_gallery")) || {};

            data.forEach(item => {
                let imgs = item.imagenes || [];
                let card = document.createElement("div");
                card.classList.add("card", colores[item.area] || "durazno");

                let liked = likes[item.id] ? "liked" : "";

                let imageHTML = "";

                if (imgs.length === 1) {
                    imageHTML = `<img src="${imgs[0]}" style="width:100%; height:200px; object-fit:cover;">`;
                } 
                else if (imgs.length === 2) {
                    imageHTML = `
                        <div class="collage two">
                            <img src="${imgs[0]}">
                            <img src="${imgs[1]}">
                        </div>`;
                } 
                else if (imgs.length === 3) {
                    imageHTML = `
                        <div class="collage three">
                            <img src="${imgs[0]}">
                            <img src="${imgs[1]}">
                            <img src="${imgs[2]}">
                        </div>`;
                } 
                else if (imgs.length >= 4) {
                    let slides = imgs.map(i => `<img src="${i}">`).join("");
                    imageHTML = `
                        <div class="carousel-container">
                            <div class="carousel-track">${slides}</div>
                        </div>
                    `;
                }

                card.innerHTML = `
                    <div class="like-container" onclick="toggleLike(${item.id})">
                        <span class="heart ${liked}">‚ù§</span>
                    </div>

                    ${imageHTML}

                    <div class="content">
                        <div class="title">${item.titulo}</div>
                        <div class="desc">${item.descripcion}</div>
                        <div class="date">${item.fecha}</div>
                    </div>
                `;

                gallery.appendChild(card);
            });
        });
}

loadGallery();

</script>

</body>
</html>
